---
import BaseLayout from '../layouts/BaseLayout.astro'
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts'
import { getCollection } from 'astro:content'

const posts = (await getCollection('blog')).sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
---

<BaseLayout title={SITE_TITLE} description={SITE_DESCRIPTION}>
  <main class='container'>
    {
      posts.map(({ slug, data: { title, description, heroImage, pubDate } }) => (
        <section class='post'>
          <div>
            <h1>{title}</h1>
            <time datetime={pubDate.toISOString()} class='pub-date'>
              {pubDate.toLocaleDateString('en-us', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
              })}
            </time>
          </div>
          <img src={heroImage} alt='Hero Image' class='hero-image' />
          <p class='description'>{description}</p>
          <button class='button'>
            <a href={`/posts/${slug}/`} class='link'>
              Read More
            </a>
          </button>
        </section>
      ))
    }
  </main>
</BaseLayout>

<style>
  .container {
    display: flex;
    flex-direction: column;
    gap: 32px;
  }

  .post {
    display: flex;
    flex-direction: column;
    gap: 8px;
    align-items: flex-start;
  }

  .pub-date {
    color: var(--light-text-color);
  }

  .hero-image {
    width: 100%;
  }

  .description {
    color: var(--light-text-color);
  }

  .button {
    background-color: var(--primary-color);
    padding: 8px;
    border: none;
    border-radius: 3px;
    cursor: pointer;
    transition: background-color ease-in-out 0.1s;
  }

  .button:hover {
    background-color: var(--primary-color-dark);
  }

  .link {
    color: white;
    text-decoration: none;
  }

  .link:visited {
    color: white;
  }
</style>
